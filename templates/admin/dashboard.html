{% extends 'base.html' %}
<style>
    .col-md-3 {
        width: 200px;
    }
</style>

<!--Thẻ style ở đây-->

{% block content %}
<div class="dashboard">
    <div class="title-table">
        <h1 style="font-weight: normal">Dashboard Quản Trị</h1>
    </div>
<div style="display: flex;">
    <!--Dùng table--->
    <div class="col-md-3" style="width: 290px; margin-right: 35px;"> <!----->
        <div class="card text-white bg-primary">
            <!--Khi Click vào thẻ Tổng sách sẽ dẫn đến trang danh sách sách-->
            <a href="{{ url_for('books') }}" style="color: white; text-decoration: none;">
            <div class="card-body">
                <h5>Tổng sách</h5> 
                <h3>{{ stats.total_books }}</h3>
            </div>
            </a>
        </div>
    </div>
    <div class="col-md-3" style="width: 290px; margin-right: 35px;">
        <div class="card text-white bg-success">
            <!--Khi Click vào thẻ Đang mượn sẽ dẫn đến trang danh sách sách đang mượn my_borrows.html-->
            <a href="{{ url_for('my_borrows') }}" style="color: white; text-decoration: none;">
                <div class="card-body">
                    <h5>Đang mượn</h5>
                    <h3>{{ stats.active_borrows }}</h3>
                </div>
            </a>
        </div>
    </div>
    <div class="col-md-3" style="width: 290px; margin-right: 35px;">
        <div class="card text-white bg-warning">
            <!--Khi Click vào thẻ Quá hạn sẽ dẫn đến trang danh sách sách quá hạn-->
            <a href="{{ url_for('admin_overdue') }}" style="color: white; text-decoration: none;">
            <div class="card-body">
                <h5>Quá hạn</h5>
                <h3>{{ stats.overdue }}</h3>
            </div>
            </a>
        </div>
    </div>
    <div class="col-md-3" style="width: 290px;">
        <div class="card text-white bg-info">
            <!--Đến trang manage_users-->
            <a href="{{ url_for('manage_users') }}" style="color: white; text-decoration: none;">
            <div class="card-body">
                <h5>Độc giả</h5>
                <h3>{{ stats.total_users }}</h3>
            </div>
            </a>
        </div>
    </div>
</div>

<hr>

<div class="row">
    <div class="col-md-6" style="text-align: center;">
        <h3 style="background-color: #696969; color: white; padding: 7px; border: 2px solid black; border-radius: 7px;"">Top 5 sách mượn nhiều nhất</h3>
        {% if top_books %}
        <table class="table table-striped table-hover"> <!----->
            <thead>
                <tr class="row-name">
                    <th scope="col" style="background-color: #A9DFBF;">Top</th>
                    <th scope="col" style="background-color: #A9DFBF;">Tên Sách</th>
                    <th scope="col" style="background-color: #A9DFBF;">Lượt Mượn</th>
                </tr>
            </thead>
            <tbody>
                {% for book in top_books %}
                <tr>
                    <th scope="row">{{ loop.index }}</th>
                    <td>{{ book.title }}</td>
                    <td>{{ book.borrow_count }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p class="text-muted">Chưa có dữ liệu sách mượn.</p>
        {% endif %}
    </div>

    <div class="col-md-6" style="text-align: center;">
        <h3 style="background-color: #696969; color: white; padding: 7px; border: 2px solid black; border-radius: 7px;">Top 5 độc giả tích cực</h3>
        {% if top_users %}
        <table class="table table-striped table-hover">
            <thead>
                <tr class="row-name">
                    <th scope="col" style="background-color: #A9DFBF;">Top</th>
                    <th scope="col" style="background-color: #A9DFBF;">Tên Độc giả</th>
                    <th scope="col" style="background-color: #A9DFBF;">Lượt Mượn</th>
                </tr>
            </thead>
            <tbody>
                {% for user in top_users %}
                <tr>
                    <th scope="row">{{ loop.index }}</th>
                    <td>{{ user.full_name if user.full_name else user.username }}</td> <!--Hiển thị tên đầy đủ của độc giả, nếu không có thì hiển thị username-->
                    <td>{{ user.borrow_count }}</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <p class="text-muted">Chưa có dữ liệu độc giả tích cực.</p>
        {% endif %}
    </div>
</div>
</div>  <!--books-header-->
{% endblock %}


{% block scripts %}
{% endblock %}